#!/usr/bin/env python
import sys, urllib, getpass

#global conf:
class ImporterAccounts:
    """Generic base-class to handle imports to ledger's format from various popular banks."""
    def __init__(self):
        self.accts=('Checking' 'Saving')
    def prompt_creds(self):
        """Get user's credentials for a given bank login."""

class ImporterTdbank(ImporterAccounts):
    """Handle import of various TDBank banking accounts."""
    def __init__(self, usr=getpass.getuser(), pas=None):
        self.creds = {'usr': usr}
        self.bank = {
            'name': 'TD Bank',
            'url': 'https://onlinebanking.tdbank.com/',
            #make this whole structure come in via conf files.
        }
        self.creds['pas'] = None #learn python's getopts and make this possible

    def prompt_creds(self):
        print 'Please enter your credentails (press ENTER for [default] values)'
        self.creds['usr'] = raw_input('username ["%s"]: ' % (self.creds['usr']))
        self.creds['pas'] = getpass.getpass('password: ')
        if not self.creds['usr']: return False
        if not self.creds['pas']: return False
        return True

    #just fiddling around:
    def _http_post_request(self):
        s = urllib2.urlopen(self.bank['url'])
        s.close()
        return s.read()

if __name__ == '__main__':
    tdbank = ImporterTdbank()
    print 'Getting exports for "%s"...' % (tdbank.bank['name'])
    if (tdbank.prompt_creds()):
        sys.stdout.write('yayy\n')
    else:
        sys.stderr.write("failll\n")
        sys.exit(3)
